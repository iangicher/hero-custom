<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<title>Products Model | Hero User Guide</title>
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js"></script>
		<script type="text/javascript" src="./../../js/shCore.js"></script>
		<script type="text/javascript" src="./../../js/shBrushPhp.js"></script>
		<script type="text/javascript" src="./../../js/shBrushXml.js"></script>
		<script type="text/javascript" src="./../../js/user_guide.js"></script>
		<link href="./../../css/user_guide.css" media="screen" rel="stylesheet" type="text/css" />
		<link href="./../../css/shCore.css" media="screen" rel="stylesheet" type="text/css" />
		<link href="./../../css/shThemeDefault.css" media="screen" rel="stylesheet" type="text/css" />
	</head>
	<body>
		<div class="header">
			Hero <span class="sub">/ User Guide</span>
		</div>
		<div class="body">
			<div id="navigation">
				<ul>
					<li>
						<a rel="basic" class="parent" href="#">Basic Details</a>
						<ul>
							<li>
								<a href="./../../index.html">Welcome to Hero</a>
							</li>
							<li>
								<a href="./../../license.html">License Agreement</a>
							</li>
							<li>
								<a href="./../../changelog.html">Changelog</a>
							</li>
						</ul>
					</li>
					<li>
						<a rel="installation" class="parent" href="#">Installation</a>
						<ul>
							<li>
								<a href="./../../installation/server_requirements.html">Server Requirements</a>
							</li>
							<li>
								<a href="./../../installation/installation.html">Fresh Installation</a>
							</li>
							<li>
								<a href="./../../installation/upgrading.html">Upgrading</a>
							</li>
							<li>
								<a href="./../../installation/migration.html">Migration</a>
							</li>
							<li>
								<a href="./../../installation/troubleshooting.html">Troubleshooting</a>
							</li>
							<li>
								<a href="./../../installation/deployment.html">Mass Deployment</a>
							</li>
						</ul>
					</li>
					<li>
						<a rel="configuration" class="parent" href="#">Configuration</a>
						<ul>
							<li>
								<a href="./../../configuration/settings.html">Settings</a>
							</li>
							<li>
								<a href="./../../configuration/coupon_codes.html">Coupon Codes</a>
							</li>
							<li>
								<a href="./../../configuration/branding.html">Custom Branding</a>
							</li>
							<li>
								<a href="./../../configuration/custom_fields.html">Custom Fields</a>
							</li>
							<li>
								<a href="./../../configuration/emails.html">Emails</a>
							</li>
							<li>
								<a href="./../../configuration/importing_members.html">Importing Members</a>
							</li>
							<li>
								<a href="./../../configuration/member_groups.html">Member Groups</a>
							</li>
							<li>
								<a href="./../../configuration/payment_gateways.html">Payment Gateways</a>
							</li>
							<li>
								<a href="./../../configuration/reports.html">Reports</a>
							</li>
							<li>
								<a href="./../../configuration/search.html">Search</a>
							</li>
							<li>
								<a href="./../../configuration/security.html">Security</a>
							</li>
							<li>
								<a href="./../../configuration/shipping.html">Shipping Rates</a>
							</li>
							<li>
								<a href="./../../configuration/subscriptions.html">Subscriptions</a>
							</li>
							<li>
								<a href="./../../configuration/taxes.html">Taxes</a>
							</li>
							<li>
								<a href="./../../configuration/advanced.html">Advanced</a>
							</li>
						</ul>
					</li>
					<li>
						<a rel="publishing" class="parent" href="#">Publishing</a>
						<ul>
							<li><a href="./../../publishing/blogs.html">Blogs</a></li>
							<li><a href="./../../publishing/content.html">Content &amp; Content Types</a></li>
							<li><a href="./../../publishing/forms.html">Forms</a></li>
							<li><a href="./../../publishing/menus.html">Navigation Menus</a></li>
							<li><a href="./../../publishing/rss_feeds.html">RSS Feeds</a></li>
							<li><a href="./../../publishing/store.html">Store Products &amp; Collections</a>
							<li><a href="./../../publishing/topics.html">Topics</a></li>
						</ul>
					</li>
					<li>
						<a rel="designers" class="parent" href="#">Designing</a>
						<ul>
							<li><a href="./../../designers/index.html">Designer Introduction</a></li>
							<li><a href="./../../designers/smarty.html">Smarty Template Engine</a></li>
							<li><a href="./../../designers/includes.html">Stylesheets &amp; JavaScript</a></li>
							<li><a href="./../../designers/template_plugins.html">Template Plugins</a></li>
							<li><a href="./../../designers/mapping_urls.html">Mapping URL's</a></li>
							<li class="reference">Reference</li>
							<li class="reference"><a href="./../../designers/reference/global_variables.html">Global Variables</a></li>
							<li class="reference"><a href="./../../designers/reference/global_plugins.html">Global Plugins</a></li>
							<li class="reference"><a href="./../../designers/reference/blogs.html">Blogs &amp; Archives</a></li>
							<li class="reference"><a href="./../../designers/reference/custom_fields.html">Custom Fields</a></li>
							<li class="reference"><a href="./../../designers/reference/forms.html">Forms</a></li>
							<li class="reference"><a href="./../../designers/reference/members.html">Members</a></li>
							<li class="reference"><a href="./../../designers/reference/menus.html">Navigation Menus</a></li>
							<li class="reference"><a href="./../../designers/reference/paywall_privileges.html">Access Restrictions &amp; Paywalls</a></li>
							<li class="reference"><a href="./../../designers/reference/publish.html">Published Content &amp; Topics</a></li>
							<li class="reference"><a href="./../../designers/reference/rss_feeds.html">RSS Feeds</a></li>
							<li class="reference"><a href="./../../designers/reference/search.html">Search Forms &amp; Results</a></li>
							<li class="reference"><a href="./../../designers/reference/store.html">Store Products &amp; Collections</a></li>
							<li class="reference"><a href="./../../designers/reference/subscriptions.html">Subscriptions</a></li>
							<li class="reference"><a href="./../../designers/reference/custom_fields.html">Custom Fields</a></li>
						</ul>
					</li>
					<li>
						<a rel="developers" class="parent active" href="#">Developing</a>
						<ul>
							<li><a href="./../../developers/index.html">Developer Introduction</a></li>
							<li><a href="./../../developers/codeigniter.html">CodeIgniter</a></li>
							<li><a href="./../../developers/standards.html">Standards &amp; Best Practices</a></li>
							<li><a href="./../../developers/security.html">Security</a></li>
							<li><a href="./../../developers/modules.html">Module Development</a></li>
							<li><a href="./../../developers/template_plugins.html">Template Plugin Development</a></li>
							<li><a href="./../../developers/cronjobs.html">Cronjobs &amp; Automated Processes</a></li>
							<li><a href="./../../developers/forms.html">Forms &amp; Custom Fieldtypes</a></li>
							<li><a href="./../../developers/errors_logging.html">Errors &amp; Logging</a></li>
							<li><a href="./../../developers/profiling.html">Debug/Profile Mode</a></li>
							<li class="reference">Reference</li>
							<li class="reference"><a href="./../../developers/reference/admin_form_library.html">Admin Form Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/admin_navigation_library.html">Admin Navigation Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/app_hooks_library.html">App Hooks Library</a></li>
							<li class="reference"><a href="./../../developers/reference/array_to_csv_library.html">Array to CSV Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/array_to_json_helper.html">Array to JSON Helper</a></li> 
							<li class="reference"><a href="./../../developers/reference/blog_model.html">Blog Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/cart_model.html">Cart Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/clean_string_helper.html">Clean String Helper</a></li> 
							<li class="reference"><a href="./../../developers/reference/collections_model.html">Collections Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/content_model.html">Content Model</a></li>
							<li class="reference"><a href="./../../developers/reference/content_type_model.html">Content Type Model</a></li>  
							<li class="reference"><a href="./../../developers/reference/coupon_model.html">Coupon Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/custom_fields_model.html">Custom Fields Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/dataset_library.html">Dataset Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/email_model.html">Email Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/fieldtype_library.html">Fieldtype Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/form_builder_library.html">Form Builder Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/form_model.html">Form Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/image_thumb_helper.html">Image Thumb Helper</a></li>
							<li class="reference"><a href="./../../developers/reference/invoice_model.html">Invoice Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/head_assets_library.html">Head Assets Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/link_model.html">Link Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/login_model.html">Login Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/menu_model.html">Menu Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/notices_library.html">Notices Library</a></li>
							<li class="reference"><a href="./../../developers/reference/order_model.html">Order Model</a></li>  
							<li class="reference"><a href="./../../developers/reference/products_model.html">Products Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/usergroup_model.html">Usergroup Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/product_option_model.html">Product Option Model</a></li>
							<li class="reference"><a href="./../../developers/reference/rss_model.html">RSS Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/setting_helper.html">Setting Helper</a></li>
							<li class="reference"><a href="./../../developers/reference/settings_model.html">Settings Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/shipping_model.html">Shipping Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/states_model.html">States Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/stats_library.html">Stats Library</a></li> 
							<li class="reference"><a href="./../../developers/reference/subscription_model.html">Subscription Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/subscription_plan_model.html">Subscription Plan Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/taxes_model.html">Taxes Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/template_files_helper.html">Template Files Helper</a></li> 
							<li class="reference"><a href="./../../developers/reference/theme_model.html">Theme Model</a></li>
							<li class="reference"><a href="./../../developers/reference/time_since_helper.html">Time Since Helper</a></li> 
							<li class="reference"><a href="./../../developers/reference/topic_model.html">Topic Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/url_helper.html">URL Helper</a></li> 
							<li class="reference"><a href="./../../developers/reference/user_model.html">User Model</a></li> 
							<li class="reference"><a href="./../../developers/reference/usergroup_model.html">Usergroup Model</a></li> 
						</ul>
						
					</li>
				</ul>
			</div>
			<div id="content">
				<h1>Products Model</h1>

<p>Manage products and product images.  This model also has helper methods like <span class="code">get_price()</span> which calculates a product's price based on the product ID, the logged-in user's member groups (if logged in), and selected product options.</p>

<h2>Initialization</h2>

<pre class="code brush: php">

$this-&gt;load-&gt;model('store/products_model');
// now methods are available at $this-&gt;products_model-&gt;x();

</pre>

<h2>Method Reference</h2>

<h3 class="method"><span class="return_type">float</span> <span class="method_name">get_price</span> <span class="arguments">(int <span class="variable">$product_id</span> [, array <span class="variable">$selected_options</span> = array()])</span></h3>

<p>Calculate the price for a product based on the product's ID (i.e., it's price), the potentially logged-in user's member groups, and the selected options for the product passed as an array of product_option_names => selected_values.</p>

<pre class="code brush: php">

$options = array(
				&#042; &lt;strong&gt;colour&lt;/strong&gt;
				'size' =&gt; 'large'
			);
			
			
$price = $this-&gt;products_model-&gt;get_price(1050, $options);

echo 'Please pay us $' . money_format(&quot;%!i&quot;, $price) . '.';

</pre>

<h3 class="method"><span class="return_type">array</span> <span class="method_name">get_custom_fields</span> <span class="arguments">()</span></h3>

<p>Retrieve all product custom fields.  This is essentially a wrapper for the <a href="./../../developers/reference/custom_fields_model.html">custom field model</a>'s method of the same name, except that it knows which custom field group is assigned to products (a stored setting).</p>

<h3 class="method"><span class="return_type">int</span> <span class="method_name">add_image</span> <span class="arguments">(int <span class="variable">$product_id</span> , string <span class="variable">$filename</span>)</span></h3>

<p>Add an image to a product.</p>

<p>Arguments:</p>

<ul>
<li><span class="code">$product_id</span> - Product ID</li>
<li><span class="code">$filename</span> - The filename of the file in <span class="filename">/writeable/product_images/</span></li>
</ul>

<h3 class="method"><span class="return_type">void</span> <span class="method_name">remove_image</span> <span class="arguments">(int <span class="variable">$image_id</span>)</span></h3>

<p>Remove an image from a product.</p>

<h3 class="method"><span class="return_type">boolean</span> <span class="method_name">make_feature_image</span> <span class="arguments">(int <span class="variable">$image_id</span>)</span></h3>

<p>Make the selected image the feature image for a product (and remove any other image from feature image status).</p>

<h3 class="method"><span class="return_type">void</span> <span class="method_name">images_reset_order</span> <span class="arguments">(int <span class="variable">$product_id</span>)</span></h3>

<p>Reset the image order for a specific product.  This is a useful method to use before <span class="code">image_update_order()</span> when sorting product images.</p>

<h3 class="method"><span class="return_type">void</span> <span class="method_name">image_update_order</span> <span class="arguments">(int <span class="variable">$field_id</span> , int <span class="variable">$new_order</span>)</span></h3>

<p>Set the order of a particular image within a product's image gallery.  <span class="code">$new_order</span> corresponds to the order of the image.  They will be displayed in ascending order.</p>

<h3 class="method"><span class="return_type">string|boolean</span> <span class="method_name">validation</span> <span class="arguments">()</span></h3>

<p>Validate the current POST data for a product submission.  If successful, it returns TRUE.  Otherwise, it returns an HTML-formatted string of errors.</p>

<h3 class="method"><span class="return_type">int</span> <span class="method_name">new_product</span> <span class="arguments">(string <span class="variable">$name</span> , string <span class="variable">$description</span> [, array <span class="variable">$collections</span> = array() [, float <span class="variable">$price</span> = '1' , int <span class="variable">$weight</span> [, boolean <span class="variable">$requires_shipping</span> = FALSE [, boolean <span class="variable">$track_inventory</span> = FALSE , float <span class="variable">$starting_inventory</span> [, boolean <span class="variable">$allow_oversell</span> = FALSE [, string <span class="variable">$sku</span> = '' [, boolean <span class="variable">$is_taxable</span> = FALSE [, array <span class="variable">$member_tiers</span> = array() [, boolean <span class="variable">$is_download</span> = FALSE [, string <span class="variable">$download_name</span> = '' , int <span class="variable">$download_size</span> [, int <span class="variable">$promotion</span> = '' [, array <span class="variable">$custom_fields</span> = array() [, array <span class="variable">$product_options</span> = array()]]]]]]]]]]]]])</span></h3>

<p>Create a new product in the database.</p>

<p>Parameter Notes:</p>

<ul>
<li><span class="code">$name</span> - Product name</li>
<li><span class="code">$description</span> - Product description</li>
<li><span class="code">$collections</span> - Array of collection ID's (default: array())</li>
<li><span class="code">$price</span> - Product price (e.g., "5.00") (default: 1)</li>
<li><span class="code">$weight</span> - Product weight in default units (default: 0)</li>
<li><span class="code">$requires_shipping</span> - Does it require a shipping address? (default: FALSE)</li>
<li><span class="code">$track_inventory</span> - Shall we track inventory? (default: FALSE)</li>
<li><span class="code">$starting_inventory</span> - How many are in stock right now? (default: 0)</li>
<li><span class="code">$allow_oversell</span> - Should we allow the product to sell at zero stock? (default: FALSE)</li>
<li><span class="code">$sku</span> - The SKU identifier (default: '')</li>
<li><span class="code">$is_taxable</span> - Is this product subject to taxes? (default: FALSE)</li>
<li><span class="code">$member_tiers</span> - A "[group]" => "[price]" array of member tiered pricing (default: array())</li>
<li><span class="code">$is_download</span> - Is this a downloadable product? (default: FALSE)</li>
<li><span class="code">$download_name</span> - Filename for the download in /writeable/product_files/ (default: '')</li>
<li><span class="code">$download_size</span> - Total size of the file, in KB (default: 0)</li>
<li><span class="code">$promotion</span> - Shall we put purchasers into a usergroup? (default: '')</li>
<li><span class="code">$custom_fields</span> - Any custom field data (default: array())</li>
<li><span class="code">$product_options</span> - Array of product_options ID's (default: array())</li>
</ul>

<h3 class="method"><span class="return_type">boolean</span> <span class="method_name">update_product</span> <span class="arguments">(int <span class="variable">$product_id</span> , string <span class="variable">$name</span> , string <span class="variable">$description</span> [, array <span class="variable">$collections</span> = array() [, float <span class="variable">$price</span> = '1' , int <span class="variable">$weight</span> [, boolean <span class="variable">$requires_shipping</span> = FALSE [, boolean <span class="variable">$track_inventory</span> = FALSE , float <span class="variable">$starting_inventory</span> [, boolean <span class="variable">$allow_oversell</span> = FALSE [, strig <span class="variable">$sku</span> = '' [, boolean <span class="variable">$is_taxable</span> = FALSE [, array <span class="variable">$member_tiers</span> = array() [, boolean <span class="variable">$is_download</span> = FALSE [, string <span class="variable">$download_name</span> = '' , int <span class="variable">$download_size</span> [, int <span class="variable">$promotion</span> = '' [, array <span class="variable">$custom_fields</span> = array() [, array <span class="variable">$product_options</span> = array()]]]]]]]]]]]]])</span></h3>

<p>Update an existing product in the database.</p>

<p>Parameter Notes:</p>

<ul>
<li><span class="code">$product_id</span> - The product ID to update</li>
<li><span class="code">$name</span> - Product name</li>
<li><span class="code">$description</span> - Product description</li>
<li><span class="code">$collections</span> - Array of collection ID's (default: array())</li>
<li><span class="code">$price</span> - Product price (e.g., "5.00") (default: 1)</li>
<li><span class="code">$weight</span> - Product weight in default units (default: 0)</li>
<li><span class="code">$requires_shipping</span> - Does it require a shipping address? (default: FALSE)</li>
<li><span class="code">$track_inventory</span> - Shall we track inventory? (default: FALSE)</li>
<li><span class="code">$starting_inventory</span> - How many are in stock right now? (default: 0)</li>
<li><span class="code">$allow_oversell</span> - Should we allow the product to sell at zero stock? (default: FALSE)</li>
<li><span class="code">$sku</span> - The SKU identifier (default: '')</li>
<li><span class="code">$is_taxable</span> - Is this product subject to taxes? (default: FALSE)</li>
<li><span class="code">$member_tiers</span> - A "[group]" => "[price]" array of member tiered pricing (default: array())</li>
<li><span class="code">$is_download</span> - Is this a downloadable product? (default: FALSE)</li>
<li><span class="code">$download_name</span> - Filename for the download in /writeable/product_files/ (default: '')</li>
<li><span class="code">$download_size</span> - Total size of the file, in KB (default: 0)</li>
<li><span class="code">$promotion</span> - Shall we put purchasers into a usergroup? (default: '')</li>
<li><span class="code">$custom_fields</span> - Any custom field data (default: array())</li>
<li><span class="code">$product_options</span> - Array of product_options ID's (default: array())</li>
</ul>

<h3 class="method"><span class="return_type">int</span> <span class="method_name">get_product_id</span> <span class="arguments">(string <span class="variable">$url_path</span>)</span></h3>

<p>Return a product ID from a URL path.  This is used in the store controller.</p>

<h3 class="method"><span class="return_type">array</span> <span class="method_name">get_product</span> <span class="arguments">(int <span class="variable">$product_id</span>)</span></h3>

<p>Return data for a particular product from an ID, in the same format as <span class="code">get_products()</span>.</p>

<h3 class="method"><span class="return_type">array</span> <span class="method_name">get_images</span> <span class="arguments">(int <span class="variable">$product_id</span>)</span></h3>

<p>Retrieve all images for a particular product.</p>

<p>The image array returned has multiple arrays (images in ascending order) with the following keys:</p>

<ul>
<li><strong>id</strong></li>
<li><strong>path</strong> - The local full server path to the file</li>
<li><strong>url</strong> - The full URL to the image</li>
<li><strong>featured</strong> - TRUE if it is the feature image, else FALSE</li>
</ul>

<h3 class="method"><span class="return_type">array</span> <span class="method_name">get_products</span> <span class="arguments">( [array <span class="variable">$filters</span> = array()])</span></h3>

<p>Return an array of products based on optional filters.  This includes a fulltext search if you use the <span class="code">keyword</span> filter.</p>

<p>Possible Filters: </p>

<ul>
<li>int <strong>id</strong></li>
<li>string <strong>type</strong> - Either "download" or "shippable"</li>
<li>string <strong>name</strong></li>
<li>int <strong>collection</strong></li>
<li>float <strong>price</strong></li>
<li>string <strong>keyword</strong></li>
<li>string <strong>sort</strong> - Field to sort by</li>
<li>string <strong>sort_dir</strong> - ASC or DESC</li>
<li>int <strong>limit</strong> - How many records to retrieve?</li>
<li>int <strong>offset</strong> - Start records retrieval at this record</li>
</ul>

<p>Each returned product array has the following data:</p>

<ul>
<li><strong>id</strong></li>
<li><strong>url</strong></li>
<li><strong>url_path</strong></li>
<li><strong>quick_add_to_cart_url</strong> - A URL that can be used to quickly add 1 of these products to your cart</li>
<li><strong>admin_link</strong></li>
<li><strong>collections</strong> </li>
<li><strong>name</strong></li>
<li><strong>description</strong></li>
<li><strong>price</strong></li>
<li><strong>weight</strong></li>
<li><strong>requires_shipping</strong></li>
<li><strong>track_inventory</strong></li>
<li><strong>inventory</strong></li>
<li><strong>inventory_allow_oversell</strong></li>
<li><strong>sku</strong></li>
<li><strong>is_taxable</strong></li>
<li><strong>member_tiers</strong></li>
<li><strong>is_download</strong></li>
<li><strong>download_name</strong> - Filename of the file</li>
<li><strong>download_fullpath</strong> - Full local server path to the download file</li>
<li><strong>download_size</strong> - Filesize, in bytes</li>
<li><strong>promotion</strong> - Promotion member group after purchase, if available</li>
<li><strong>feature_image</strong> - Full local server path to the feature image file</li>
<li><strong>feature_image_url</strong> - Full URL to the image file</li>
<li><strong>options</strong> - An array of product option ID's, if this product has product options</li>
<li><strong>relevance</strong> (if a <strong>keyword</strong> filter was specified)</li>
</ul>

<h3 class="method"><span class="return_type">void</span> <span class="method_name">delete_product</span> <span class="arguments">(int <span class="variable">$product_id</span>)</span></h3>

<p>Delete an existing product.</p>

<h3 class="method"><span class="return_type">int</span> <span class="method_name">knock_inventory</span> <span class="arguments">(int <span class="variable">$product_id</span>)</span></h3>

<p>Reduce a product's inventory by 1 (after purchase).</p>
			</div>
		</div>
	</body>
</html>
<!-- /developers/reference-->